"use strict";function initialize(){var o={zoom:6,center:new google.maps.LatLng(35.644033,-121.1875503),mapTypeControl:!1,disableDefaultUI:!0},e=new google.maps.Geocoder;bounds=new google.maps.LatLngBounds,map=new google.maps.Map(document.getElementById("map-canvas"),o);for(var n=0;n<initLocs.length;n++){var t=initLocs[n].address;e.geocode({address:t},addMarker(n))}}function addMarker(o){var e=function(e,n){n==google.maps.GeocoderStatus.OK?(marker=new google.maps.Marker({position:e[0].geometry.location,map:map,animation:google.maps.Animation.DROP,icon:{url:"http://maps.google.com/mapfiles/ms/icons/purple.png",size:new google.maps.Size(25,40),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(12.5,40)},shape:{coords:[1,25,-40,-25,1],type:"poly"}}),markers.push(marker),infoWindow=new google.maps.InfoWindow,infoWindowContent(o,function(o){infoWindow.setContent(o),infoWindows.push(infoWindow)}),autoCenter(e[0].geometry.location),google.maps.event.addListener(marker,"click",function(){function e(){n.setAnimation(null)}var n=this;infoWindowContent(o,function(o){infoWindow.setContent(windowContent),infoWindow.open(map,n)}),toggleBounce(n),setTimeout(e,3e3)})):alert("location fail to geocode : "+n)};return e}function autoCenter(o){++locationNum,bounds.extend(o),locationNum===initLocs.length&&map.fitBounds(bounds)}function infoWindowContent(o,e){return fourSquareUrl=fourSquareBaseUrl+initLocs[o].title+"&ll="+initLocs[o].lat+","+initLocs[o].lng,$.getJSON(fourSquareUrl).done(function(o){var n=o.response.venues[0],t=n.name,i=n.location.formattedAddress,a=void 0===n.contact.formattedPhone?"None":n.contact.formattedPhone;windowContent='<div class="info-window"><p><strong>Name: </strong>'+t+"</p><p><strong>Address: </strong>  "+i+"</p><p><strong>Phone: </strong>"+a+"</p></div>",e(windowContent)}).fail(function(o,e,n){alert("Failed to connect to Foursquare: "+e+" "+o.status+" "+n)}),geocodeCallBack}function autoCenter(o){++locationNum,bounds.extend(o),locationNum===initLocs.length&&map.fitBounds(bounds)}function infoWindowContent(o,e){fourSquareUrl=fourSquareBaseUrl+initLocs[o].title+"&ll="+initLocs[o].lat+","+initLocs[o].lng,$.getJSON(fourSquareUrl).done(function(o){var n=o.response.venues[0],t=n.name,i=n.location.formattedAddress,a=void 0===n.contact.formattedPhone?"None":n.contact.formattedPhone;windowContent='<div class="info-window"><p><strong>Name: </strong>'+t+"</p><p><strong>Address: </strong>  "+i+"</p><p><strong>Phone: </strong>"+a+"</p></div>",e(windowContent)}).fail(function(o,e,n){alert("Failed to connect to Foursquare: "+e+" "+o.status+" "+n)})}function toggleBounce(o){currentMarker&&currentMarker.setAnimation(null),currentMarker=o,o.setAnimation(google.maps.Animation.BOUNCE)}var map,fourSquareUrl,marker,markers=[],CLIENT_ID="HFL5YZCURJPD00BQUGRDJK5WN2YET54N2KZPJHU4LOCZ0HXN",CLIENT_SECRET="N3DUX3TQWRCSREJHHZGPPXCKY2RRIXARDZKHOCPZZT5HGHHX",fourSquareBaseUrl="https://api.foursquare.com/v2/venues/search?client_id="+CLIENT_ID+"&client_secret="+CLIENT_SECRET+"&v=20160105&query=",infoWindow,infoWindows=[],windowContent,bounds,initLocs,locationNum=0,currentMarker=null;initLocs=[{title:"Sea World",lat:32.7639528,lng:-117.2267477,id:"nav0",address:"500 Sea World Dr,San Diego, CA 92109",visible:ko.observable(!0),boolTest:!0},{title:"Disney Land",lat:33.805825,lng:-117.9229715,id:"nav1",address:"1313 Disneyland DrAnaheim, CA 92802",visible:ko.observable(!0),boolTest:!0},{title:"Hearst Castle",lat:35.644033,lng:-121.1875503,id:"nav2",address:"750 Hearst Castle Rd San Simeon, CA 93452",visible:ko.observable(!0),boolTest:!0},{title:"Monterey Bay Aquarium",lat:36.618266,lng:-121.902339,id:"nav3",address:"886 Cannery Row Monterey, CA 93940",visible:ko.observable(!0),boolTest:!0},{title:"Golden Gate Bridge",lat:37.819929,lng:-122.478255,id:"nav4",address:"Pier 39, San Francisco, CA 94111",visible:ko.observable(!0),boolTest:!0},{title:"Lake Elsinore",lat:33.7529,lng:-116.0556,id:"nav5",address:"130 South Main Street ,Lake Elsinore, CA 92530",visible:ko.observable(!0),boolTest:!0},{title:"Santa Barbara Zoo",lat:34.419527,lng:-119.66801,id:"nav6",address:"500 Ninos Dr, Santa Barbara, CA 93103",visible:ko.observable(!0),boolTest:!0},{title:"Universal Studios Hollywood",lat:34.137868,lng:-118.352863,id:"nav7",address:"100 Universal City Plaza, Universal City, CA 91608",visible:ko.observable(!0),boolTest:!0},{title:"Great America Pkwy",lat:37.397946,lng:-121.974294,id:"nav8",address:"4701 Great America Pkwy, Santa Clara, CA 95054",visible:ko.observable(!0),boolTest:!0}];var Loc=function(o){this.title=ko.observable(o.title)},viewModel=function(){function o(o){e.locList.removeAll();for(var n=0;n<initLocs.length;n++)infoWindows[n].close(),markers[n].setVisible(!1),initLocs[n].title.toLowerCase().indexOf(o.toLowerCase())>=0&&(e.locList.push(new Loc(initLocs[n])),markers[n].setVisible(!0))}function o(o){e.locList.removeAll();for(var n=0;n<initLocs.length;n++)infoWindows[n].close(),markers[n].setVisible(!1),initLocs[n].title.toLowerCase().indexOf(o.toLowerCase())>=0&&(e.locList.push(new Loc(initLocs[n])),markers[n].setVisible(!0))}var e=this;e.query=ko.observable(""),e.isDisplayOpen=ko.observable(!0),e.locList=ko.observableArray([]),initLocs.forEach(function(o){e.locList.push(new Loc(o))}),e.toggleDisplay=function(){e.isDisplayOpen(!e.isDisplayOpen())},e.toggleDisplayText=ko.computed(function(){return e.isDisplayOpen()?"<<":">>"}),e.toogleDisplayStatus=ko.computed(function(){return e.isDisplayOpen()?!0:!1}),e.openInfoWindow=function(o){for(var e,n=0;n<initLocs.length;n++)initLocs[n].title==o.title&&(e=markers[n],toggleBounce(e),infoWindowContent(n,function(o){infoWindow.setContent(o),infoWindow.open(map,e)}),setTimeout(function(){e.setAnimation(null)},3e3))},e.initLocs=ko.computed(function(){var o=e.query().toLowerCase();return ko.utils.arrayFilter(initLocs,function(e){return e.title.toLowerCase().indexOf(o)>=0?e.visible(!0):e.visible(!1)})}),e.search=function(){o(e.query())}};ko.applyBindings(new viewModel);